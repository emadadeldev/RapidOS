---
title: Visual Effects configuration
actions:
  - !powerShell:
      runas: currentUserElevated
      exeDir: true
      command: |
        .\RapidScripts\EnvSetup.ps1
        $memGB = [math]::Round(((Get-CimInstance Win32_PhysicalMemory | Measure-Object Capacity -Sum).Sum) / 1GB)

        # === Paths ===
        $visualEffectsPath = 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects'
        $desktopPath = 'HKCU:\Control Panel\Desktop'
        $windowMetricsPath = 'HKCU:\Control Panel\Desktop\WindowMetrics'
        $advancedExplorerPath = 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
        $dwmPath = 'HKCU:\SOFTWARE\Microsoft\Windows\DWM'
        $personalizePath = 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize'

        # === Core UI settings ===
        Set-RegistryValue -Path $visualEffectsPath -Name 'VisualFXSetting' -Type DWORD -Value 3
        Set-RegistryValue -Path $desktopPath -Name 'UserPreferencesMask' -Type Binary -Value ([byte[]](0x90, 0x12, 0x03, 0x80, 0x10, 0x00, 0x00, 0x00))
        Set-RegistryValue -Path $windowMetricsPath -Name 'MinAnimate' -Type String -Value 0
        Set-RegistryValue -Path $advancedExplorerPath -Name 'TaskbarAnimations' -Type DWORD -Value 0
        Set-RegistryValue -Path $dwmPath -Name 'EnableAeroPeek' -Type DWORD -Value 0
        Set-RegistryValue -Path $advancedExplorerPath -Name 'ListviewAlphaSelect' -Type DWORD -Value 1
        Set-RegistryValue -Path $personalizePath -Name 'EnableTransparency' -Type DWORD -Value 0
        Set-RegistryValue -Path $advancedExplorerPath -Name 'ListviewShadow' -Type DWORD -Value 0
        Set-RegistryValue -Path $desktopPath -Name 'DragFullWindows' -Type String -Value 1
        Set-RegistryValue -Path $dwmPath -Name 'AlwaysHibernateThumbnails' -Type DWORD -Value 0
        Set-RegistryValue -Path $advancedExplorerPath -Name 'IconsOnly' -Type DWORD -Value 0
        Set-RegistryValue -Path $desktopPath -Name 'FontSmoothing' -Type String -Value 2

        # === RAM-dependent settings ===
        if ($memGB -ge 8) {
          Set-RegistryValue -Path $desktopPath -Name 'UserPreferencesMask' -Type Binary -Value ([byte[]](0x90, 0x12, 0x07, 0x80, 0x12, 0x00, 0x00, 0x00))
          Set-RegistryValue -Path $windowMetricsPath -Name 'MinAnimate' -Type String -Value 1
          Set-RegistryValue -Path $advancedExplorerPath -Name 'TaskbarAnimations' -Type DWORD -Value 1
          Set-RegistryValue -Path $dwmPath -Name 'EnableAeroPeek' -Type DWORD -Value 1
          Set-RegistryValue -Path $personalizePath -Name 'EnableTransparency' -Type DWORD -Value 1
        }